<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    <title>Samples</title>
  </head>
  <body>
  	<div id="samples">
	    <h1>Samples</h1>
	    
	    <ul id="sample-list">
	    Loading...
	    </ul>
    </div>
    
    <div id="gamebox"></div>

    <script src="http://dart.googlecode.com/svn/branches/bleeding_edge/dart/client/dart.js"></script>
    <script type="application/dart">
    #import('dart:html');

	getQueryArgs() {
	  var queryString = window.location.search;
	  var result = {};
	  if (queryString.length < 1) {
	    return result;
	  } else {
	    queryString = queryString.substring(1);
	  }
	  for (var arg in queryString.split('&')) {
	    var pair = arg.split('=');
	    result[pair[0]] = pair[1];
	  }
	  return result;
	}
	
	main () {
	  var sampleTitles = {
	    'helloworld': 'Hello world!',
	    'simplesprite': 'Simple sprite'
	  };
	
	  var demoName = getQueryArgs()['sample'];
	  if (demoName == null) {
	    query('#sample-list').text = '';
	    sampleTitles.forEach((key, value) {
	      var listItem = new LIElement();
	      var link = new AnchorElement('${window.location.href}?sample=${key}');
	      link.text = value;
	      listItem.elements.add(link);
	      query('#sample-list').elements.add(listItem);
	    });
	  } else {
	    var title = sampleTitles[demoName];
	    if (title == null) {
	      throw 'Unknown demo';
	    }
	    var script = new ScriptElement();
	    script.type = 'application/dart';
	    script.src = 'sample_${demoName}.dart';
	    document.body.elements.add(script);
	
	    window.document.title = title;
	    query('#samples').hidden = true;
	  }
	}
    </script>
  </body>
</html>
